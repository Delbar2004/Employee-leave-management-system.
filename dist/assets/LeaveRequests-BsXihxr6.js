import{c as N,g as E,a as B,r as i,Q as v,j as e,m as I,X as $,f as M,C as F}from"./index-uPpi8n1S.js";import{l as L}from"./leaveService-CJtUEa2x.js";import{S as H,F as P,C as J,a as U,R as V}from"./search-BdZlJNNC.js";import{E as X}from"./eye-08_ejs7h.js";import{C as W}from"./check-circle-DaBNDna2.js";import{f as d}from"./format-BZscouVm.js";import{p as c}from"./parseISO-Yj3askoI.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=N("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=N("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=N("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),re=()=>{const f=E();B();const[m,w]=i.useState([]),[o,p]=i.useState([]),[T,k]=i.useState(!0),[a,g]=i.useState(null),[x,b]=i.useState(""),[u,A]=i.useState(!1),[s,D]=i.useState({status:"",type:"",department:"",startDate:"",endDate:"",searchTerm:""}),[h,C]=i.useState(!1);i.useEffect(()=>{const r=new URLSearchParams(f.search).get("id");if(r){const l=r;j().then(()=>{const y=m.find(q=>q.id===l);y&&g(y)})}else j()},[f.search]);const j=async()=>{try{k(!0);const t=await L.getAllLeaveRequests();return w(t),p(t),t}catch(t){return console.error("Error fetching leave requests:",t),v.error("Failed to load leave requests"),[]}finally{k(!1)}};i.useEffect(()=>{let t=[...m];if(s.status&&(t=t.filter(r=>r.status===s.status)),s.type&&(t=t.filter(r=>r.leaveType===s.type)),s.department&&(t=t.filter(r=>r.department===s.department)),s.startDate){const r=new Date(s.startDate);t=t.filter(l=>new Date(l.startDate)>=r)}if(s.endDate){const r=new Date(s.endDate);t=t.filter(l=>new Date(l.endDate)<=r)}if(s.searchTerm){const r=s.searchTerm.toLowerCase();t=t.filter(l=>l.employeeName.toLowerCase().includes(r)||l.leaveType.toLowerCase().includes(r)||l.reason.toLowerCase().includes(r)||l.department.toLowerCase().includes(r))}p(t)},[s,m]);const n=t=>{const{name:r,value:l}=t.target;D(y=>({...y,[r]:l}))},S=()=>{D({status:"",type:"",department:"",startDate:"",endDate:"",searchTerm:""})},R=async t=>{if(a){C(!0);try{await L.reviewLeaveRequest(a.id,t,x);const r=m.map(l=>l.id===a.id?{...l,status:t,reviewedBy:"John Admin",reviewedOn:new Date().toISOString(),comments:x}:l);w(r),p(o.map(l=>l.id===a.id?{...l,status:t,reviewedBy:"John Admin",reviewedOn:new Date().toISOString(),comments:x}:l)),g({...a,status:t,reviewedBy:"John Admin",reviewedOn:new Date().toISOString(),comments:x}),b(""),v.success(`Leave request ${t}`)}catch(r){console.error(`Error ${t} leave request:`,r),v.error(`Failed to ${t} leave request`)}finally{C(!1)}}},z=t=>{switch(t){case"approved":return"bg-success-100 text-success-800 dark:bg-success-900/30 dark:text-success-300";case"pending":return"bg-accent-100 text-accent-800 dark:bg-accent-900/30 dark:text-accent-300";case"rejected":return"bg-error-100 text-error-800 dark:bg-error-900/30 dark:text-error-300";case"cancelled":return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},O=Array.from(new Set(m.map(t=>t.leaveType)));return T?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-600 dark:bg-primary-400 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-600 dark:bg-primary-400 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-600 dark:bg-primary-400 animate-bounce",style:{animationDelay:"300ms"}})]})}):e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Leave Requests"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Review and manage employee leave requests"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 space-y-4 md:space-y-0",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(H,{size:16,className:"text-gray-500 dark:text-gray-400"})}),e.jsx("input",{type:"text",className:"input pl-10 w-full",placeholder:"Search by name, type...",name:"searchTerm",value:s.searchTerm,onChange:n})]}),e.jsxs("div",{className:"flex items-center space-x-2 w-full md:w-auto",children:[e.jsxs("button",{onClick:()=>A(!u),className:"btn btn-outline px-3 py-2",children:[e.jsx(P,{size:16,className:"mr-2"}),"Filters",u?e.jsx(J,{size:16,className:"ml-2"}):e.jsx(U,{size:16,className:"ml-2"})]}),e.jsx("button",{onClick:j,className:"btn btn-outline px-3 py-2","aria-label":"Refresh",children:e.jsx(V,{size:16})})]})]}),u&&e.jsxs("div",{className:"card mb-6 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"label",children:"Status"}),e.jsxs("select",{id:"status",name:"status",className:"input",value:s.status,onChange:n,children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",className:"label",children:"Leave Type"}),e.jsxs("select",{id:"type",name:"type",className:"input",value:s.type,onChange:n,children:[e.jsx("option",{value:"",children:"All Types"}),O.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"label",children:"Department"}),e.jsxs("select",{id:"department",name:"department",className:"input",value:s.department,onChange:n,children:[e.jsx("option",{value:"",children:"All Departments"}),I.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"startDate",className:"label",children:"From Date"}),e.jsx("input",{type:"date",id:"startDate",name:"startDate",className:"input",value:s.startDate,onChange:n})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endDate",className:"label",children:"To Date"}),e.jsx("input",{type:"date",id:"endDate",name:"endDate",className:"input",value:s.endDate,onChange:n})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{onClick:S,className:"btn btn-outline px-3 py-2",children:[e.jsx($,{size:16,className:"mr-2"}),"Reset Filters"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h2",{className:"text-lg font-medium text-gray-900 dark:text-white",children:["Leave Requests",e.jsxs("span",{className:"ml-2 text-sm text-gray-500 dark:text-gray-400",children:["(",o.length,")"]})]})}),o.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Employee"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Leave Type"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Duration"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:o.map(t=>e.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-750 transition-colors ${(a==null?void 0:a.id)===t.id?"bg-gray-50 dark:bg-gray-750":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:e.jsx(M,{size:16,className:"text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.employeeName}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.department})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:t.leaveType}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[d(c(t.startDate),"MMM dd")," - ",d(c(t.endDate),"MMM dd")]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900 dark:text-white",children:[t.duration," day",t.duration!==1?"s":""]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Applied ",d(c(t.appliedOn),"MMM dd")]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`badge ${z(t.status)} capitalize`,children:t.status})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>g(t),className:"text-primary-600 hover:text-primary-900 dark:text-primary-400 dark:hover:text-primary-300 mr-3",children:e.jsx(X,{size:16})}),e.jsx("div",{className:"relative inline-block text-left",children:e.jsx("button",{className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:e.jsx(G,{size:16})})})]})]},t.id))})]})}):e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx(F,{size:24,className:"text-gray-500 dark:text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-1",children:"No leave requests found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:s.status||s.type||s.department||s.startDate||s.endDate||s.searchTerm?"Try adjusting your filters to see more results":"There are no leave requests to review at this time"}),(s.status||s.type||s.department||s.startDate||s.endDate||s.searchTerm)&&e.jsx("button",{onClick:S,className:"btn btn-outline",children:"Reset Filters"})]})]})}),e.jsx("div",{children:a?e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex justify-between items-start",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Request Details"}),e.jsx("span",{className:`badge ${z(a.status)} capitalize`,children:a.status})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:e.jsx(M,{size:20,className:"text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:a.employeeName}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a.department})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Leave Type"}),e.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:a.leaveType})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Start Date"}),e.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:d(c(a.startDate),"MMM dd, yyyy")})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"End Date"}),e.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:d(c(a.endDate),"MMM dd, yyyy")})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Duration"}),e.jsxs("p",{className:"mt-1 text-gray-900 dark:text-white",children:[a.duration," working day",a.duration!==1?"s":""]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Reason"}),e.jsx("p",{className:"mt-1 text-gray-900 dark:text-white whitespace-pre-line",children:a.reason})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Applied On"}),e.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:d(c(a.appliedOn),"MMM dd, yyyy")})]}),a.reviewedOn&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Reviewed On"}),e.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:d(c(a.reviewedOn),"MMM dd, yyyy")})]})]}),a.reviewedBy&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Reviewed By"}),e.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:a.reviewedBy})]}),a.comments&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Comments"}),e.jsx("p",{className:"mt-1 text-gray-900 dark:text-white",children:a.comments})]}),a.status==="pending"&&e.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"comments",className:"label flex items-center",children:[e.jsx(Q,{size:16,className:"mr-2"}),"Comments (optional)"]}),e.jsx("textarea",{id:"comments",rows:3,className:"input",placeholder:"Add your comments here...",value:x,onChange:t=>b(t.target.value)})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>R("approved"),disabled:h,className:"btn btn-success flex-1",children:h?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"Approving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(W,{size:16,className:"mr-2"}),"Approve"]})}),e.jsx("button",{type:"button",onClick:()=>R("rejected"),disabled:h,className:"btn btn-error flex-1",children:h?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e.jsx("span",{children:"Rejecting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{size:16,className:"mr-2"}),"Reject"]})})]})]})]})})]}):e.jsx("div",{className:"card p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mb-4",children:e.jsx(F,{size:24,className:"text-gray-500 dark:text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-1",children:"No request selected"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Select a leave request to view details"})]})})})]})]})};export{re as default};
